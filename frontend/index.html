<html>

<head>
  <script type="text/javascript" src="/vue.js"></script>
  <script src="/polyfill.min.js"></script>
  <script src="/bootstrap-vue.js"></script>
  <script type="module">
    import App from '/app.js';
    import info_header from '/info-header.js';
    import copy_url_button from '/copy-url-button.js';
  </script>

  <link type="text/css" rel="stylesheet" href="/bootstrap.min.css" />
  <link type="text/css" rel="stylesheet" href="/bootstrap-vue.css" />

  <style>
    #players .voting-btn {
      float: right;
    }
    .voted {
      background-color: red;
      font-size: 17pt;
    }
    .info-header {
      text-align: center;
      color: rgb(56, 47, 36);
    }
    #create-town {
      display: block;
      float: left;
      justify-content: center;
    }
    #container {
      display: flex;
      flex-flow: column;
      justify-content: center;
      align-items: center;
    }
    </style>
</head>

<body>
  <div class="container">
    <div class="row">
      <div id="app" class="col-lg-3">


        <info-header v-bind:state="appState.state.id"></info-header>


        <h2 v-if="appState.state.id === 'waiting_for_players'">Town name: {{ appState.slug }}</h2>

        <div id="game-ended" v-if="appState.state.id === 'game_ended'">Game is Ended!</div>

        <div id="new-town-form" v-if="appState.state.id === 'new_town_form'">
          <b-form-group label="Town name">
            <b-form-input id="town-slug" v-model="appState.slug" type="text" placeholder="Enter town name"></b-form-input>
          </b-form-group>

          <b-form-group label="Player name">
            <b-form-input id="player-name" v-model="playerName" type="text" placeholder="input your player name" />
            </b-form-input>
          </b-form-group>

          <b-button id="create-town" v-on:click=createTown :disabled="!appState.slug || !playerName">
            Create town
          </b-button>
        </div>

        <div id="waiting-for-players" v-if="appState.state.id === 'waiting_for_players'">
          <h3>Players:</h3>

          <b-list-group>
            <b-list-group-item v-for="player in appState.players">{{player.name}}</b-list-group-item>
          </b-list-group>

          <div v-if="!currentPlayer">
            <b-form-group label="Player name">
              <b-form-input id="player-name" v-model=playerName type="text" placeholder="input your name"></b-form-input>
            </b-form-group>

            <b-button id="join-town" v-on:click=joinTown :disabled=!playerName>Join town</b-button>
          </div>

          <b-button id="start-game" v-if=canShowStartButton v-on:click=startGame>Start game</b-button>
        </div>

        <div id="day-voting" v-if="appState.state.id === 'day_voting'">

          <b-list-group id="players">
            <b-list-group-item v-for="player in appState.players" v-bind:id="player.name" v-bind:class="{ voted: hasVotedOn(player) }">
              {{player.name}}
              <b-button class='voting-btn' v-if="canVoteOn(player)" v-on:click="vote(player)">Vote!</b-button>
            </b-list-group-item>
          </b-list-group>
        </div>

        <div id="night-voting" v-if="appState.state.id === 'night_voting'">
          <b-list-group id="players">
            <b-list-group-item v-for="player in appState.players" v-bind:id="player.name" v-bind:class="{ voted: hasVotedOn(player) }">
              {{player.name}}
              <b-button class='voting-btn' v-if="canVoteOn(player)" v-on:click="vote(player)">Vote!</b-button>
            </b-list-group-item>
          </b-list-group>
        </div>

        <div id="progress" v-if="canShowProgressButton">
          <b-button id='progress-btn' v-on:click=progressState>Continue Game</b-button>
        </div>

        <copy-url-button/>

        <debug v-bind:value="appState" />
      </div>
    </div>
  </div>
</body>

</html>
